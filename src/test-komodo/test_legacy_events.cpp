#include <gtest/gtest.h>
#include <boost/filesystem.hpp>
#include <vector>
#include <string>

#include "util.h"
#include "chainparams.h"

#include "komodo_globals.h"
#include "main.h"
#include "primitives/transaction.h"
#include "core_io.h"
#include "komodo.h"
#include "komodo_notary.h"

// https://bitcointalk.org/index.php?topic=1605144.msg32538076#msg32538076 - notarization txes explained

namespace fs = boost::filesystem;

namespace LegacyEventsTests {

    constexpr const char* strKMDLTCNotaHex = /* 2b4a299ed7c9b3444b9bbfd091783f4f1d4b1b70987505de926312a4ba5d9026 */ "0400008085202f890de75353322bad6580d8d349b47f80362b73d7a391ebf76cb455c9a22da81162d51d000000484730440220436b3772c4f508b8ea0904b7c1c05b93b72dcbbfe284ef98c2314cc7761dd289022044207efe4d61201ba1c3fdaab9aa9b164bf9da983cfdc884532f2556d2e3332001ffffffffc2fb445d59fdf56fbdee6da85182626006e3965f6543b552408a439414784a8f0e00000048473044022053fb98f7e7a99398a2745ca6982e72a0cd29b6dc35eb7d267af60776399ad64c02206435029c413dc68227dcb4055e7f0ffd8cc53d40452d13ad8ad11e762e4b3b4301fffffffff25ba9881d55c5f7e52984ba7b8e708e0a9536335076301b74b8af648af88ba50400000049483045022100c591e4148e583a721e42dadf0c137253913a1613714580e76dcf8a59260d026902205655a76161b912a992e716341c12f43d4f74942c3105b2a4a385631287e3873301ffffffff861026dc3790e6c59292dd8db9581f317e0cf4137283668b7b1686a91291e9770a000000484730440220551301509286c016e05c1db5b6e2a052791cb7295b54cd00f396a05c0cf89dee02200450fee4174fa93b1b5e40b3ff8bc9baec19f45080c1f8c73d452d09783ddd8801ffffffff5703a4413921d8bf3b719678094419f46948b41e4bda01863c11c61f803649db020000004948304502210091c5ccade0b5e4174fbba895bc8105c2f1ca0149c5f8b071f0176b97147e20c00220563254719049becb4f8bb5a50faa737077d378ffc15e93a96f357228182ba5d201ffffffffaf9c7e4cff68ccacc7ae9f1087deaaf136e850738d43a7ed5054b37329df54910600000049483045022100c9561b0754a17f55c4b35d36e46df6d3845b83de88efd565d73bc50e83cbecba0220183865eb8446ad165733b9360d8ab9a0fdda7e73a3114d0feed7352c70d9972f01ffffffff1ed36a28c72c36710e4ae6849ee5f90511341c99f6a34235f150661f4445d2650000000049483045022100c7a7300841d671379f65075405eb85ee2930b417b5ede49ddb83d7717644cebd0220432e9aa745c65a0c30f408b5a9473dc38e1cb375eca5c640c7ed630444d503cf01fffffffff84acac4ddf0c87b9bbb40eadc485b891776153dff371872a4957ad1b40c07b50c0000004948304502210098d3c2b126f6f6022c6982c2a1ba600f575622911bdc1dff0a05fd093044340902207c50e568da145c751be8ded10bef6aabe1d4429f67253dbaac95242e2b8def2901ffffffff508000fa6bd1131fae49413a5ec8b1d3f479314e94527e39063532055aa8edde0700000049483045022100c7cb0a95afd3602ab07d2b9c1f390f3e81f438e555a8adf9fa52b810361920950220488ef1ef6b5fc50590b3d847fbffaaf9868c0f379750f0921acb73512d3a798901ffffffff4de7e7744f14114711defb6bb517bdf0b3edf53013d030da4d5ac7aad45542311300000049483045022100e6a4fe994cfbc028692eee048c4ed8d6dd9c63daa16c644bdd8ae72e3dcea56e02207597d0ceebb6e5a4a5d9802c5b9da2cf37a21f85f344b6acd8577b029410d21201ffffffffc14defef7bbd2dcf06502e18b8b0012fed83f5e644213401c8a1113501df1e6802000000494830450221009f414593f661a7b8c06defa585bdc428dac04234042357ac9a3b11108a26071d02204a862f72675dd8b46f9a1b93d44bd388eb819667bd3e7e7a30266491f8f5710501ffffffffd87d4c2d10fbf27c9800523e05bb43b2599bb9c8e9486b42b012f66c7a6f77ea13000000484730440220047c5eaabd6df36c8bfdd0737a367a12161629aa530c6012241cc36a88fa837d02207eda8879273887b954656e29ba1e98a7dce17cd66061d861e39a12521d6474fa01ffffffff774cdee54eda73eef85696f32c8f4ec8c03977e6536765ef0998482edd7c338e1d00000049483045022100cfb0758d9c1bcbb797d54ad0849b77055f1a2811b559ba2a59aaf38ac4cfb17802202d36f77b6bd9f41281937e39154708e58c82932386fdd8a75ef50d0feeff1c1701ffffffff02f0810100000000002321020e46e79a2a8d12b9b5d12c7a91adb4e454edfae43c0a0cb805427d2ac7613fd9ac00000000000000004a6a48a99470dba8fd1887b7f98e55aebbae41215c45667288662a4a529e70c9a283093c843500238ec4fea5df560a1fe88573a14c31f20c91e31d47ee9f12482bbf8f7a887f1f4b4d440000000000000000000000000000000000000000";
    /*
        OP_RETURN:

        a99470dba8fd1887b7f98e55aebbae41215c45667288662a4a529e70c9a28309
            = 0983a2c9709e524a2a66887266455c2141aebbae558ef9b78718fda8db7094a9 - KMD Block #3507260 // srchash
        c843500 - 3507260 // notarizedheightp
        238ec4fea5df560a1fe88573a14c31f20c91e31d47ee9f12482bbf8f7a887f1f
            - echo "$1" | dd conv=swab 2> /dev/null | rev
            = https://blockchair.com/litecoin/transaction/1f7f887a8fbf2b48129fee471de3910cf2314ca17385e81f0a56dfa5fec48e23  - if name matched current chain // desttxid

        4b4d4400
    */

    CTransaction CreateCoinBaseTransaction(int nBlockHeight) {
        // Create coinbase transaction
        auto consensusParams = Params().GetConsensus();
        CMutableTransaction mtx = CreateNewContextualCMutableTransaction(consensusParams, nBlockHeight);
        CScript scriptSig = (CScript() << nBlockHeight << CScriptNum(1)) + COINBASE_FLAGS;
        mtx.vin.push_back(CTxIn(COutPoint(), scriptSig, 0));
        mtx.vout.push_back(CTxOut(300000000, CScript() << ParseHex("031111111111111111111111111111111111111111111111111111111111111111") << OP_CHECKSIG));
        CTransaction tx(mtx);
        return tx;
    }

    class LegacyEvents: public ::testing::Test {

        private:
            boost::filesystem::path pathDataDir;
            void printMessage(const std::string &message) {
                std::cout << "[          ] " << message;
            }
        public:
            LegacyEvents() : pathDataDir("") {}

            std::ostream& LogMessage() {
                std::cout << "[          ] ";
                return std::cout;
            }

            void SetUp( ) {

                /* Set environment for each test */
                pathDataDir.clear(); ClearDatadirCache();

                fPrintToConsole = true;
                fPrintToDebugLog = false;

                fs::path tempDir = fs::temp_directory_path();
                fs::path uniqueDir = tempDir / fs::unique_path();
                if (fs::create_directories(uniqueDir)) {
                    mapArgs["-datadir"] = uniqueDir.string();
                    pathDataDir = GetDataDir(false);
                }

                STAKED_NOTARY_ID = -1; // should be set via komodo_args call in real world
                SelectParams(CBaseChainParams::MAIN); // by default it's a CBaseChainParams::REGTEST, see ./src/test-komodo/main.cpp
                chainName = assetchain();

                komodo_setactivation(Consensus::NetworkUpgrade::ALWAYS_ACTIVE); // act as UpdateNetworkUpgradeParameters for regtest, to set sapling & overwinter activation height, but for mainnet

                KOMODO_REWIND = 0;
                chainActive.SetTip(nullptr);

                mempool.clear();
            }

            void TearDown( ) {

                fPrintToDebugLog = true;
                fPrintToConsole = false;

                if (!pathDataDir.empty()) {
                    fs::remove_all(pathDataDir);
                }

                mapArgs.erase("-datadir");
                pathDataDir.clear();

                chainActive.SetTip(nullptr);
                komodo_setactivation(Consensus::NetworkUpgrade::NO_ACTIVATION_HEIGHT);
                SelectParams(CBaseChainParams::REGTEST);

                mempool.clear();
            }
    };

    TEST_F(LegacyEvents, PhantomOpReturnEvent) {

        int32_t fakeBlockHeight = 3507273;

        std::vector<std::string> vHexTxes = {
            strKMDLTCNotaHex,
            /* c495d8b31491bf5ef3d5f123344b9596ac84d604ca509d7f982400f33a6fc7ec */ "0400008085202f8901a2efbc1573128738a37fa5638800357eb309db7aee22eef3c7825aa962a86b380600000048473044022073e8a265ac732ddd480d9ccfbade1f71c98976d91061bc7abeaae96665fd00dd0220299fd6a23e4ab5e4b299f7d29a2da9c87a893901975ed38722c69dd0126f8bd201ffffffff0288130000000000002321020e46e79a2a8d12b9b5d12c7a91adb4e454edfae43c0a0cb805427d2ac7613fd9ac0000000000000000226a20e9a57645780b4559dbefc76111e450a37937d8ce5d70b0f2063e88d1c7dbd24c00000000000000000000000000000000000000"
        };

        std::vector<CTransaction> txes;

        bool fAllTxesConverted = true;
        std::transform(vHexTxes.begin(), vHexTxes.end(), std::back_inserter(txes), [&fAllTxesConverted](const std::string& strHexTx) {
            CTransaction tx;
            fAllTxesConverted &= DecodeHexTx(tx, strHexTx);
            return tx;
        });

        ASSERT_TRUE(fAllTxesConverted);

        CBlock b;

        // Compose a block
        b.vtx.push_back(CreateCoinBaseTransaction(fakeBlockHeight));
        b.vtx.insert(b.vtx.end(), txes.begin(), txes.end());

        CBlockIndex indexDummy(b);
        indexDummy.nHeight = fakeBlockHeight;
        //indexDummy.nTime = GetTime();
        chainActive.SetTip(&indexDummy);
        int32_t res_kcb = komodo_connectblock(false, &indexDummy, b);

        komodo_state *state_ptr = komodo_stateptrget((char *)chainName.symbol().c_str()); // &KOMODO_STATES[0]

        ASSERT_TRUE(state_ptr != nullptr);
        ASSERT_TRUE(state_ptr->events.size() == 0);

        /*
            we shouldn't have matched == 1 on 3rd transaction in a block here, as a result,
            we shouldn't have komodo_voutupdate -> komodo_stateupdate -> write_event call
            and komodoevents file should be empty
        */

        uintmax_t stateFileSize = 0;
        fs::path filePath = GetDataDir(false) / KOMODO_STATE_FILENAME; // instead of komodo_statefname call
        if (fs::exists(filePath) && fs::is_regular_file(filePath)) {
            stateFileSize = fs::file_size(filePath);
        }

        ASSERT_TRUE(stateFileSize == 0);
    }

    TEST_F(LegacyEvents, NormalKMDLTCNota) {

        /* Test for normal KMD -> LTC nota in KMD chain */

        ASSERT_TRUE(mempool.mapTx.size() == 0); // be sure that mempool is empty at the begin of test
        int32_t fakeBlockHeight = 3507273;

        std::vector<std::string> vHexNotaInputsTxes = {
            /* https://kmdexplorer.io/tx/d56211a82da2c955b46cf7eb91a3d7732b36807fb449d3d88065ad2b325353e7/%3E/29 */ "0400008085202f8901f7c7cb7594b9f1d34d06de01b434410d6b30f4e5ea02ff9807c05c345d5697f31b0000006b483045022100afff458392eb0094e98eea5852fd79abd75caf2440836bd12b50a73178542eae02205ec4160a96b43ae3794e595a182e0a8e56c19e3630b23feb04458f17e4ae2884012103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ffffffff1f1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4ac1027000000000000232103955c7999538cee313bf196a7df59db208c651f6a5a1b0eed94732ba753b4f3f4aca54b0ac1010000001976a914eb12f821ed7c9ac21c8a67bdcd0ff01ffcd9ce3c88ac2a94b564000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/8f4a781494438a4052b543655f96e30660628251a86deebd6ff5fd595d44fbc2/%3E/14 */ "0400008085202f8901a7bf96918e451370f1554ba6b04fc35abc7b4ac4f1eb96fd0767096112fa213f1c0000006b483045022100eb8283c33341c5da0af0f5f4ce34ca72858b28112dc01fa7f554fdf58a5dccc8022071113a8dc659c70850701df5c4c7a210f5a02fe65cefc75dc278448e4cd5e3fc012102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ffffffff1e1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac1027000000000000232102bbc5518d27918d77c46b4e3ad0b9df936df520646527ab4c2f206544a2b03967ac67638fe0000000001976a91409b5e12290f48bc1d9dc5b8d26807252be95656388ac2a94b564000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/a58bf88a64afb8741b3076503336950a8e708e7bba8429e5f7c5551d88a95bf2/%3E/4 */ "0400008085202f89019e8b1e02b1ea4a0c2096031531e50f4d135a461f67e61b635ed05b0df4f35daf200000006b4830450221008cf781a9fcc8080037d8fc914649cd085ff6161e33fb28505de77458171bc52a02201a6bba76bc3ca910a6fa32284d18707c8f68e9cb5cf8c52f4da7e9da4988a1a7012102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acffffffff1b1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac1027000000000000232102340bf4749a392865b0ddaf37e652195e740c7538aeac87f7a51b8bf2dcdc24acac70659393070000001976a9146deb008e8c10fb4783a1c5d09e8099710f98bedc88ac228db564000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/77e99112a986167b8b66837213f40c7e311f58b98ddd9292c5e69037dc261086/%3E/10 */ "0400008085202f89016be666653aeb9b8f56f27452e602c8232a3cd8d287c9cb3158a68dfa2beb5d58220000006a473044022026280c80a8faf08e7d309287066b97bfbfbdc0affaa6ab557c631661e2b9bb5802200c62637648dc2e87135a3337c285d98ab80767c174403e4ec9c7680cd3153e2e0121035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ffffffff1f10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac10270000000000002321035baa12331ad6c284d5f1b76527c1d6c5eb15a74b9ba369e5d46aefcc9c120938ac81b254b30f0000001976a9143c874ea8a4248615ba0838c873e0a79a459c6b0788acd291b564000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/db4936801fc6113c8601da4b1eb44869f41944097896713bbfd8213941a40357/%3E/2 */ "0400008085202f8901d98abab325206b3a72ef09403850260b3704bd36f7b658961687eecc3c10766e0b0000006b48304502210093cc9efb948134858c8033fe2bef73d64df45cc6446ca54e13ce2c493f3fe5ec02202c73c9010bcf710b687eb9bcadad6f15706d5ef34a5162da16550bf335f19a13012103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ffffffff0e1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac1027000000000000232103bea1ac333b95c8669ec091907ea8713cae26f74b9e886e13593400e21c4d30a8ac80115302000000001976a9142ef9bded2a17342ad5d324a5d707de92df3bd8ff88ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/9154df2973b35450eda7438d7350e836f1aade87109faec7accc68ff4c7e9caf/%3E/6 */ "0400008085202f8901faac01550081530fa7ac000aad923c39ec15972d15aef06bae2770c22f1238330b0000006a47304402202ce1d5a92cdc5962b4243f179fbe3d65d60ea4addb560d2e8c0f347782ed3036022014e679afb75494a4879320c15206286f699ab0a826b21c02741fae262412716f012103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdffffffff101027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdac1027000000000000232103bb749e337b9074465fa28e757b5aa92cb1f0fea1a39589bca91a602834d443cdacf86f620d000000001976a9140ba28b34ebd21d0b18e8753e71c2663c171bec9888ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/65d245441f6650f13542a3f6991c341105f9e59e84e64a0e71362cc7286ad31e/%3E/0 */ "0400008085202f890199ed45b0f4b2d5f20952a8c7d017fa7bcafd3ebfc5273b1c44e6c42a7351e34f0c0000006b483045022100f82e67c52f7ca63344b18085a74adbd57edff32fdc475a8dec4ca6a44ffcb4e5022034f4f597d39b3df66ac376c8be27ff809140baddf6e70977c19d7dce1884f97e012102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ffffffff0e1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8ac1027000000000000232102f0b3ef87629509441b1ae95f28108f258a81910e483b90e0496205e24e7069b8acd8a4b310000000001976a914972fa06fb0c15e139aa9da07e29bc57047e4d92288ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/b5070cb4d17a95a4721837ff3d157617895b48dcea40bb9b7bc8f0ddc4ca4af8/%3E/12 */ "0400008085202f8901acd5998aa532c8d7453626c047b11ed17d0132f2fad014aa81fdca492259819b370000006b483045022100c8a59aef8d3d95769b6699da83e18c853735a046405c0f97a183b2c67bb8e3cc022057c59b13cfc09ab2f7d7a04cd02d7e49e5579cc3784f6e8451738193c40ade54012103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ffffffff2e1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac1027000000000000232103a8c071036228e0900e0171f616ce1a58f0a761193551d68c4c20e70534f2e183ac6a22b604000000001976a91420dcd1cea9c288c9097fc74163495bc317da28c488ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/deeda85a05323506397e52944e3179f4d3b1c85e3a4149ae1f13d16bfa008050/%3E/7 */ "0400008085202f89015d96e2c7947571ffdd0ae0a5a57d842db902427aa02eace4cf69d08698ba526d0f0000006b4830450221009e7ff18404c17f3339ae290e7dbff2fdd66c282251a7f7c1ea6752cd045d981c022070512e525940eb656654bed189d79ec91d5dc449f84774aff8ad9b6ee19691d60121027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bf2ffffff1010270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac10270000000000002321027dfe5403f8870fb0e1b94a2b4204373b31ea73179ba500a88dd56d22855cd03bac6a9e3765000000001976a914d64d6f5f96865f7d5e79fc0577c93ef437cf903688ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/314255d4aac75a4dda30d01330f5edb3f0bd17b56bfbde114711144f74e7e74d/%3E/19 */ "0400008085202f890193a6435e1a0bb7c61d351344ac5b42817a62dd71199c40738560f82e24e4858a140000006b483045022100f95f2bb13b63f8664f0971e3f008fdb21dd06074259d9dda880d867a634ada560220089f36d09494d5af0b3efe665f098b52f716b780fa929f9ee797dcc336fab20c0121022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acf2ffffff1710270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac10270000000000002321022a2a45979a6631a25e4c96469423de720a2f4c849548957c35a35c91041ee7acac0b9d5f8e010000001976a914740a3bd4ce730e3e4109d05f0944f369321f43ee88ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/681edf013511a1c801342144e6f583ed2f01b0b8182e5006cf2dbd7befef4dc1/%3E/2 */ "0400008085202f8901c1cf11b23674bc7a14c4ca813fc012005ea75bf84ca679534a4b0a1028a1e0ac150000006b48304502210082aa302e68e057a4e8a34c8c3157fccff4b85971ec8921342a5ff97c053ce31a02205cb0a3c149f8cf13dddb3e7737edd885ed5ca73716a151a1a58d53bfdf7c14e3012102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9f2ffffff151027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac1027000000000000232102eb3aad81778f8d6f7e5295c44ca224e5c812f5e43fc1e9ce4ebafc23324183c9ac0b43a123010000001976a914bb3ce123d2e24f67aab158d4e55bb93fb7c9476b88ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/ea776f7a6cf612b0426b48e9c8b99b59b243bb053e5200987cf2fb102d4c7dd8/%3E/19 */ "0400008085202f89014ad8ae2c0be0248cc0fea0a831d2e98a52d9718f2206a33f01b4595edcab1a4f140000006b48304502210085f09a897505bff7cece2c8a94027e6d276f79c8404aa57a76a5264cf0376b54022072049b9e8c9f0ea5ce66e45d723cc4363374fdc577467bfa434dea5a9d1dee6c0121026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efef2ffffff1710270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac10270000000000002321026e33b213be94fa7c05c781cb1d2fb381e4c4ef6aad40d6a67f0a8ad573d92efeac744bf8ff000000001976a914bb3c96b371e912efc77d5312bd39bbc12abb7c5a88ac00000000000000000000000000000000000000",
            /* https://kmdexplorer.io/tx/8e337cdd2e489809ef656753e67739c0c84e8f2cf39656f8ee73da4ee5de4c77/%3E/29 */ "0400008085202f89012c147d87c9e8bcbe017209e2e1652f955eb624a90ef08edef3617490b9545f793f0000006a4730440220294cf60304a4c98509bce01cef2f7716c9e4949922f2856a0f78ed317a0c1b8a022062cd890d2b6663fbc3e69b939d94668a5b541afbadd5065dfbb65880adaf0747012103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fffffffff2f1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812fac1027000000000000232103af7f8c82f20671ca1978116353839d3e501523e379bfb52b1e05d7816bb5812facbd335c04000000001976a914deb6190cadd4d9b38eddd81a5fc3df21733721a288ac00000000000000000000000000000000000000"
            /* */
        };

        std::vector<CTransaction> vNotaInputsTxes;

        bool fAllTxesConverted = true;
        std::transform(vHexNotaInputsTxes.begin(), vHexNotaInputsTxes.end(), std::back_inserter(vNotaInputsTxes), [&fAllTxesConverted](const std::string& strHexTx) {
            CTransaction tx;
            fAllTxesConverted &= DecodeHexTx(tx, strHexTx);
            return tx;
        });
        ASSERT_TRUE(fAllTxesConverted);

        // put vNotaInputsTxes in mempool to allow GetTransaction in gettxout_scriptPubKey
        bool fAllInputsInMempool = true;
        auto consensusBranchId = CurrentEpochBranchId(fakeBlockHeight + 1, Params().GetConsensus());
        for (const CTransaction &in_tx : vNotaInputsTxes) {
            CTxMemPoolEntry entry(in_tx, 0, GetTime(), 0, chainActive.Height(), mempool.HasNoInputsOf(in_tx), false, consensusBranchId);
            mempool.addUnchecked(in_tx.GetHash(), entry, false);
            fAllInputsInMempool &= mempool.exists(in_tx.GetHash());
        }

        ASSERT_TRUE(fAllInputsInMempool);
        ASSERT_TRUE(mempool.size() == vHexNotaInputsTxes.size());

        CTransaction notaTx;
        ASSERT_TRUE(DecodeHexTx(notaTx, strKMDLTCNotaHex));

        CBlock b;
        // Compose a block
        b.vtx.push_back(CreateCoinBaseTransaction(fakeBlockHeight));
        b.vtx.push_back(notaTx);

        CBlockIndex indexDummy(b);
        indexDummy.nHeight = fakeBlockHeight;
        //indexDummy.nTime = GetTime();
        chainActive.SetTip(&indexDummy);
        int32_t res_kcb = komodo_connectblock(false, &indexDummy, b);

        komodo_state *state_ptr = komodo_stateptrget((char *)chainName.symbol().c_str()); // &KOMODO_STATES[0]
        ASSERT_TRUE(state_ptr != nullptr);
        ASSERT_TRUE(state_ptr->NumCheckpoints() == 1);
        ASSERT_TRUE(state_ptr->SAVEDHEIGHT == fakeBlockHeight);

        /*
            komodo_stateupdate will be called 2 times here:

            1. [ komodo::event_notarized ]
               inside komodo_voutupdate komodo_stateupdate(height,0,0,0,zero,0,0,0,0,0,0,0,0,sp->LastNotarizedMoM(),sp->LastNotarizedMoMDepth()); and
               this call will trigger komodo::event_notarized creation inside komodo_stateupdate and write_event to disk. Then in komodo_eventadd_notarized
               it will call komodo_state::add_event<komodo::event_notarized>, but it will not be added (!) in events list because add_event adds events to
               the list only for assetchains (!). Is it expected behavior? Then komodo_notarized_update will be called and checkpoint to numpoints will be
               added via AddCheckpoint.
            2. [ komodo::event_kmdheight ]
               Second time komodo_stateupdate will be called from komodo_connectblock: komodo_stateupdate(height,0,0,0,zero,0,0,height,(uint32_t)pindex->nTime,0,0,0,0,zero,0)
               and for this time it will trigger komodo::event_kmdheight event creation. it will also be written to disk, but will not be added to events list
               in komodo_eventadd_kmdheight, bcz add_event adds events to this list only for assetchains. Additionally komodo_eventadd_kmdheight will be called
               with future call to komodo_setkmdheight (or rewind event create) and SAVEDHEIGHT, SAVEDTIMESTAMP and CURRENT_HEIGHT possible update.
        */

    }
}
